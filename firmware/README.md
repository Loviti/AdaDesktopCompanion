# Ada Particles — ESP32 Belly Display Firmware

Renders images as living particle clouds on a 466x466 AMOLED display.
Images are generated by Ada's server (SD-Turbo diffusion) and sent over WebSocket as base64-encoded RGB pixels. The particles float, swirl, pulse, and drift based on Ada's emotional state.

## Hardware

- **Board:** Waveshare ESP32-S3-Touch-AMOLED-1.75
- **Display:** 466x466 AMOLED with CO5300 driver (QSPI)
- **SoC:** ESP32-S3 with 8MB PSRAM

## Arduino IDE Setup

### Board Settings
- **Board:** ESP32S3 Dev Module
- **PSRAM:** OPI PSRAM
- **Flash Size:** 16MB
- **Partition Scheme:** Huge APP (3MB No OTA/1MB SPIFFS)
- **USB CDC On Boot:** Enabled

### Required Libraries
- [Arduino_GFX_Library](https://github.com/moononournation/Arduino_GFX_Library)
- [ESP32_IO_Expander](https://github.com/esp-arduino-libs/ESP32_IO_Expander)
- [ArduinoWebsockets](https://github.com/gilmaimon/ArduinoWebsockets)
- [ArduinoJson](https://github.com/bblanchon/ArduinoJson)

## Configuration

Edit `config.h`:
```cpp
#define WIFI_SSID "YOUR_WIFI_SSID"
#define WIFI_PASSWORD "YOUR_WIFI_PASSWORD"
#define SERVER_HOST "10.10.10.100"  // Ada server IP
```

## Protocol

The server sends JSON messages over WebSocket:

### `particles` — New image + config
```json
{
  "type": "particles",
  "image": "<base64 RGB pixels>",
  "width": 128,
  "height": 128,
  "config": { ... }
}
```

### `mood` — Config-only update (no new image)
```json
{
  "type": "mood",
  "config": {
    "particle_count": 800,
    "particle_size": 3.0,
    "particle_speed": 1.0,
    "dispersion": 30.0,
    "animation": "float",
    ...
  }
}
```

### `clear` — Fade out all particles
```json
{"type": "clear"}
```

## Animation Types

- **float** — gentle random drift around home position (LISTENING)
- **drift** — very slow lazy movement (IDLE)
- **swirl_inward** — particles orbit toward center (THINKING)
- **pulse_outward** — particles push outward in waves (TALKING)

## Files

- `ada_particles.ino` — Main sketch (WiFi, WebSocket, render loop)
- `config.h` — Pin definitions, network config, physics defaults
- `particle_system.h` — Particle physics engine and renderer
- `base64_decode.h` — Base64 decoder for image data
